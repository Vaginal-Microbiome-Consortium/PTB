#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Thu Sep 21 22:52:03 2017

@author: tarodz
"""
import matplotlib as mpl
#mpl.use('Agg')
import matplotlib.pyplot as plt;
import seaborn as sns;
import pandas as pd;
import numpy as np;
import pickle
from pandas import DataFrame;
import scipy.stats;
import scipy;
from collections import defaultdict;
import sys;
import statsmodels.stats.multitest;



np.random.seed(1234);

np.set_printoptions(precision=3,suppress=True,linewidth=200);

#Open file for reading to remap names

f = open ('Abbrev-Species.csv','r')

#Create dictionary for abbreviations

abbrev = {}

for line in iter(f):

    ln = line.split(",")

    abbrev[ln[0].strip()] = ln[1].strip()

f.close()

def boxPlotAll(x_all,isSignif,y,colName,pAdj,log10='log10-5'):
    
    letters='abcdefghijklmnop';
    
    yp=y>0;
    yn=y<=0;

    fCnt=isSignif.shape[0];
    
    sigCnt=int(np.sum(isSignif));

    f, ax = plt.subplots(nrows=1,ncols=sigCnt, sharex=False, sharey=False)
    
    #color of median
    medianprops = dict(color='white') 
    whiskerprops=dict(color='black',linestyle='-')
    boxprops=dict(color='black')
    
    sI=0;
    
    bplots=[];
    
    print("Blue: TB, Red: PTB")
    print("On the plot, from left to right:")
    for cI in range(0,fCnt):
        if (isSignif[cI]>0):
            
            print(colNames[cI][5:]+" FDR-adjusted p-value:"+str(pAdj[cI]))
        
            x=x_all[:,cI];

            xp=x[yp];
            xn=x[yn];

            nCnt=xn.shape[0];
            pCnt=xp.shape[0];
            
            axC=ax[sI];
            
            medianprops = dict(color='white') 
            whiskerprops=dict(color='black',linestyle='-')
            boxprops=dict(color='black');
            
            yl=xn;
            yr=xp;
            bplt=axC.boxplot((yl,yr), whis='range',labels=['-','+'], sym='',manage_xticks=True,positions=[-0.1,0.6],widths=[0.35,0.35],medianprops=medianprops,notch=False,patch_artist=True,whiskerprops=whiskerprops,boxprops=boxprops)  #whis=[25, 75]


            bplt['boxes'][0].set_facecolor('#4393c3')
            bplt['boxes'][1].set_facecolor('#d6604d')
            if (sI>0):
                axC.spines['left'].set_visible(False)
            axC.spines['right'].set_visible(False)
            axC.spines['top'].set_visible(False)
            axC.spines['bottom'].set_visible(False)
            axC.tick_params(labeltop='off', labelright='off',top='off', right='off')
            if (sI==0):
                if (log10=='log10-5'):
                    axC.set_ylim(ymin=-0.1,ymax=5.1)
                    axC.set_yticks([0,1,2,3,4,5])
                    axC.set_yticklabels(['0',"$10^{-4}$","$10^{-3}$", "$10^{-2}$", "$10^{-1}$", "1"])
                if (log10=='log10-3'):
                    axC.set_ylim(ymin=-0.1,ymax=3.1)
                    axC.set_yticks([0,1,2,3])
                    axC.set_yticklabels(['0', "$10^{-2}$", "$10^{-1}$", "1"])
            else:
                if (log10=='log10-5'):
                    axC.set_ylim(ymin=-0.1,ymax=5.1)
                    axC.set_yticks(())
                if (log10=='log10-3'):
                    axC.set_ylim(ymin=-0.1,ymax=3.1)
                    axC.set_yticks(())
        
              
            axC.set_xlabel(abbrev[colName[cI][5:]], rotation=45) 
            sI=sI+1;

    ax[0].set_ylabel('vaginal 16S rRNA abundance')
    
    plt.show();
        
    return f;





def normalizeX(x,nt):
    x=x.copy();
    if (nt=='raw-5'):
        x[x<0.00001]=0;
        return x;
    if (nt=='log10-5'):
        return np.log10((x+0.00001)/0.00001);


def getMWUPs(x_all,y,log10=False):
    fCnt=x_all.shape[1];

    yp=y>0;
    yn=y<=0;

    xp=x_all[yp];
    xn=x_all[yn];

    p=np.ones((fCnt,))
    fStats=np.zeros((fCnt,100));

    for i in range(0,fCnt):
        try:
            j=0;
            xpf=xp[:,i].flatten();
            xnf=xn[:,i].flatten();
            xaf=x_all[:,i].flatten();

            _,p[i]=scipy.stats.mannwhitneyu(xpf,xnf,alternative='two-sided');

            fStats[i,j+0]=np.mean(xaf);
            fStats[i,j+1]=np.mean(xpf);
            fStats[i,j+2]=np.mean(xnf);
            fStats[i,j+3]=fStats[i,j+1]-fStats[i,j+2];
            j=j+4;
            fStats[i,j+0]=np.std(xaf);
            fStats[i,j+1]=np.std(xpf);
            fStats[i,j+2]=np.std(xnf);
            fStats[i,j+3]=fStats[i,j+1]-fStats[i,j+2];
            j=j+4;
            fStats[i,j+0]=np.median(xaf);
            fStats[i,j+1]=np.median(xpf);
            fStats[i,j+2]=np.median(xnf);
            fStats[i,j+3]=fStats[i,j+1]-fStats[i,j+2];
            j=j+4;
            fStats[i,j+0]=np.percentile(xaf,75);
            fStats[i,j+1]=np.percentile(xpf,75);
            fStats[i,j+2]=np.percentile(xnf,75);
            fStats[i,j+3]=fStats[i,j+1]-fStats[i,j+2];
            j=j+4;
            fStats[i,j+0]=np.percentile(xaf,25);
            fStats[i,j+1]=np.percentile(xpf,25);
            fStats[i,j+2]=np.percentile(xnf,25);
            fStats[i,j+3]=fStats[i,j+1]-fStats[i,j+2];
            j=j+4;
            fStats[i,j+0]=np.percentile(xaf,75)-np.percentile(xaf,25);
            fStats[i,j+1]=np.percentile(xpf,75)-np.percentile(xpf,25);
            fStats[i,j+2]=np.percentile(xnf,75)-np.percentile(xnf,25);
            fStats[i,j+3]=fStats[i,j+1]-fStats[i,j+2];
            j=j+4;
        except ValueError:
            pass

    hAdj,pAdj, alphacSidak, alphacBonf=statsmodels.stats.multitest.multipletests(p,alpha=0.05,method='fdr_bh')
    return p,pAdj,fStats;


cstr='config';
cstr=cstr+';'+'featID';
cstr=cstr+';'+'p-adj';
cstr=cstr+';'+'p-raw';

cstr=cstr+';'+'mean_all';
cstr=cstr+';'+'mean_p';
cstr=cstr+';'+'mean_n';
cstr=cstr+';'+'mean_p-n';

cstr=cstr+';'+'std_all';
cstr=cstr+';'+'std_p';
cstr=cstr+';'+'std_n';
cstr=cstr+';'+'std_p-n';

cstr=cstr+';'+'median_all';
cstr=cstr+';'+'median_p';
cstr=cstr+';'+'median_n';
cstr=cstr+';'+'median_p-n';

cstr=cstr+';'+'pct75_all';
cstr=cstr+';'+'pct75_p';
cstr=cstr+';'+'pct75_n';
cstr=cstr+';'+'pct75_p-n';

cstr=cstr+';'+'pct25_all';
cstr=cstr+';'+'pct25_p';
cstr=cstr+';'+'pct25_n';
cstr=cstr+';'+'pct25_p-n';

cstr=cstr+';'+'IQR_all';
cstr=cstr+';'+'IQR_p';
cstr=cstr+';'+'IQR_n';
cstr=cstr+';'+'IQR_p-n';

cstr=cstr+';'+'taxa';
print(cstr);


(x_data,x_clr_data,x_colNames,y_data,t_data,df_data)=pickle.load(open('data-sets-manuscript/firstVisits-full-oneALLV.pkl','rb'))

nonFDRp=0.05;

normType='raw-5';
normType2='log10-5';
x_all_base=x_data;
x_all=normalizeX(x_all_base,normType);
x_all2=normalizeX(x_all_base,normType2);
n_all=x_all.shape[0];
colNames=x_colNames;
expNameCurr='FV'+normType;


pRaw,pAdj,fStats=getMWUPs(x_all,y_data,log10=False);
fCnt=x_all.shape[1];

cntSignif=0;

isSignif=np.zeros((fCnt,))

for cI in range(0,fCnt):
    cn=colNames[cI][5:];
    cn=cn.replace('/','-')
    cstr=expNameCurr;
    cstr=cstr+';'+str(cI);
    cstr=cstr+';'+str(pAdj[cI]);
    if (pAdj[cI]<=0.05):
        cntSignif=cntSignif+1;
        isSignif[cI]=1;
    cstr=cstr+';'+str(pRaw[cI]);
    for sfI in range(0,24):
        cstr=cstr+';'+str(fStats[cI,sfI]);
    cstr=cstr+';'+colNames[cI][5:];
    print(cstr)
    
print("SIGNIF COUNT:"+str(cntSignif))


f=boxPlotAll(x_all2,isSignif,y_data,colNames,pAdj,log10=normType2)
f.savefig('paperFigs/Main-Fig2b.pdf',dpi=600,bbox_inches='tight')#,pad_inches=.05)

'''

config;featID;p-adj;p-raw;mean_all;mean_p;mean_n;mean_p-n;std_all;std_p;std_n;std_p-n;median_all;median_p;median_n;median_p-n;pct75_all;pct75_p;pct75_n;pct75_p-n;pct25_all;pct25_p;pct25_n;pct25_p-n;IQR_all;IQR_p;IQR_n;IQR_p-n;taxa
FVraw-5;0;0.7965505357263833;0.7812256048072925;0.3720564842224121;0.35205739736557007;0.3820560574531555;-0.02999866008758545;0.3724662959575653;0.36018139123916626;0.37806272506713867;-0.017881333827972412;0.2338290512561798;0.1614798754453659;0.2389116883277893;-0.0774318128824234;0.7437766790390015;0.7201550602912903;0.754167452454567;-0.03401239216327667;0.019050700590014458;0.02067323960363865;0.018365786410868168;0.002307453192770481;0.724725978448987;0.6994818206876516;0.7358016660436988;-0.036319845356047153;Lactobacillus_iners
FVraw-5;1;0.03249135776081749;0.01374634366803817;0.13448499143123627;0.044334132224321365;0.17956042289733887;-0.1352262906730175;0.3090478479862213;0.2000836431980133;0.34227731823921204;-0.14219367504119873;0.00017701661272440106;0.00010657921666279435;0.0002811672165989876;-0.00017458799993619323;0.0018554815906099975;0.0005380720249377191;0.009052566019818187;-0.008514493994880468;4.5878727178205736e-05;1.4604296666220762e-05;7.721562178630847e-05;-6.261132512008771e-05;0.0018096028634317918;0.0005234677282714983;0.008975350398031878;-0.00845188266976038;Lactobacillus_crispatus_cluster
FVraw-5;2;0.02782175586751738;0.010700675333660531;0.08785547316074371;0.133165642619133;0.06520038843154907;0.06796525418758392;0.2109212875366211;0.2447431981563568;0.1877293586730957;0.05701383948326111;8.60289073898457e-05;0.0006139727192930877;5.537430115509778e-05;0.0005585984181379899;0.0022989452118054032;0.09589442610740662;0.0006415247917175293;0.09525290131568909;1.5263799468812067e-05;4.080244980286807e-05;3.3651451758487383e-06;3.743730462701933e-05;0.002283681412336591;0.09585362365760375;0.0006381596465416806;0.09521546401106207;Lachnospiraceae_BVAB1
FVraw-5;3;0.05478410538272619;0.027392052691363095;0.09534171968698502;0.11624450981616974;0.08489032089710236;0.03135418891906738;0.1437593698501587;0.131157785654068;0.14856399595737457;-0.01740621030330658;0.02003338932991028;0.08219045400619507;0.00400965940207243;0.07818079460412264;0.1338939666748047;0.1530892550945282;0.08558658137917519;0.06750267371535301;0.00014827069389866665;0.0007394297863356769;9.783499990589917e-05;0.0006415947864297777;0.13374569598090602;0.15234982530819252;0.08548874637926929;0.06686107892892323;Gardnerella_vaginalis
FVraw-5;4;0.0786821602345346;0.042367317049364785;0.06177143380045891;0.050692398101091385;0.06731094419956207;-0.016618546098470688;0.1502186357975006;0.09042544662952423;0.17224407196044922;-0.08181862533092499;0.001610996201634407;0.012773387134075165;0.00019908662943635136;0.012574300504638813;0.04460517503321171;0.053592950105667114;0.016296888701617718;0.037296061404049397;1.4063761682336917e-05;8.629244257463142e-05;0.0;8.629244257463142e-05;0.04459111127152937;0.05350665766309248;0.016296888701617718;0.037209768961474765;Atopobium_vaginae
FVraw-5;5;0.014864916271293514;0.0040020928422713304;0.031084608286619186;0.055388059467077255;0.018932880833745003;0.03645517863333225;0.07001177966594696;0.09859399497509003;0.04526688903570175;0.053327105939388275;0.0013852869160473347;0.012144702486693859;0.0005412548780441284;0.01160344760864973;0.02428656816482544;0.05698611959815025;0.009373537497594953;0.0476125821005553;6.114422649261542e-05;0.0002417572250124067;5.9592342950054444e-05;0.00018216488206235226;0.024225423938332824;0.05674436237313785;0.009313945154644898;0.04743041721849295;Prevotella_cluster2
FVraw-5;6;0.7965505357263833;0.7965505357263833;0.0204811729490757;0.011054995469748974;0.025194266811013222;-0.014139271341264248;0.06818445771932602;0.029010247439146042;0.08053720742464066;-0.051526959985494614;2.8072145141777582e-05;2.8072145141777582e-05;2.8166597985546105e-05;-9.445284376852214e-08;0.0008455759088974446;0.0014650821685791016;0.0008348656410817057;0.0006302165274973959;0.0;0.0;0.0;0.0;0.0008455759088974446;0.0014650821685791016;0.0008348656410817057;0.0006302165274973959;Lactobacillus_jensenii
FVraw-5;7;0.5677348671393024;0.48039104142556355;0.023219216614961624;0.021782945841550827;0.023937350139021873;-0.0021544042974710464;0.09897799789905548;0.0960230901837349;0.10041513293981552;-0.0043920427560806274;1.1471704965515528e-05;0.0;1.1567980436666403e-05;-1.1567980436666403e-05;8.391531446250156e-05;5.7388810091651976e-05;0.00010257695976179093;-4.5188149670138955e-05;0.0;0.0;0.0;0.0;8.391531446250156e-05;5.7388810091651976e-05;0.00010257695976179093;-4.5188149670138955e-05;Lactobacillus_gasseri_cluster
FVraw-5;8;0.10443528207403971;0.06426786589171675;0.0187857523560524;0.02229960262775421;0.017028825357556343;0.005270777270197868;0.03567221760749817;0.03305184841156006;0.036787062883377075;-0.0037352144718170166;7.030415872577578e-05;0.01031528040766716;2.9444971005432308e-05;0.010285835436661728;0.025262901559472084;0.030861975625157356;0.0190704851411283;0.011791490484029055;0.0;0.0;0.0;0.0;0.025262901559472084;0.030861975625157356;0.0190704851411283;0.011791490484029055;Megasphaera_OTU70_type1
FVraw-5;9;0.0022605221267822224;0.00017388631744478635;0.01635020598769188;0.028159262612462044;0.010445675812661648;0.017713586799800396;0.056253161281347275;0.05672015622258186;0.05507675185799599;0.0016434043645858765;3.96432114939671e-05;0.0007139646331779659;1.1397825801395811e-05;0.0007025668073765701;0.0019483218784444034;0.021489044651389122;0.00031104154186323285;0.02117800310952589;0.0;1.2796069313480984e-05;0.0;1.2796069313480984e-05;0.0019483218784444034;0.02147624858207564;0.00031104154186323285;0.021165207040212408;Sneathia_amnii
FVraw-5;10;0.17772926814332576;0.12304333948384091;0.005244907457381487;0.0031896939035505056;0.006272515282034874;-0.0030828213784843683;0.02899807132780552;0.009719271212816238;0.034798454493284225;-0.025079183280467987;0.0001165704961749725;4.4831656850874424e-05;0.0001580921234562993;-0.00011326046660542488;0.0008252401603385806;0.0003131912089884281;0.0008771645807428285;-0.0005639733717544004;0.0;0.0;1.5177840168689727e-05;-1.5177840168689727e-05;0.0008252401603385806;0.0003131912089884281;0.0008619867405741388;-0.0005487955315857107;Prevotella_bivia
FVraw-5;11;0.10188917942089727;0.0587822188966715;0.003867379855364561;0.004382087383419275;0.003610026091337204;0.0007720612920820713;0.018417371436953545;0.011715834960341454;0.020975463092327118;-0.009259628131985664;0.0;2.804931136779487e-05;0.0;2.804931136779487e-05;0.0004928459820803255;0.0022807708010077477;5.2731586947629694e-05;0.002228039214060118;0.0;0.0;0.0;0.0;0.0004928459820803255;0.0022807708010077477;5.2731586947629694e-05;0.002228039214060118;Mycoplasma_hominis
FVraw-5;12;0.004929699258044424;0.0005688114528512798;0.006580298766493797;0.007190309464931488;0.006275293417274952;0.0009150160476565361;0.019221074879169464;0.012902544811367989;0.021694647148251534;-0.008792102336883545;0.00011296881712041795;0.0030650885310024023;3.747549999388866e-05;0.0030276130310085136;0.004285801900550723;0.008133848197758198;0.0014073258789721876;0.00672652231878601;0.0;9.189487172989175e-05;0.0;9.189487172989175e-05;0.004285801900550723;0.008041953326028306;0.0014073258789721876;0.006634627447056118;Dialister_cluster51
FVraw-5;13;0.7070251719188861;0.6525306327467089;0.005111981183290482;0.003404070157557726;0.0059659359976649284;-0.0025618658401072025;0.01627199724316597;0.008107657544314861;0.019029241055250168;-0.010921583510935307;0.00021790414757560939;0.00019861302280332893;0.0002541491703595966;-5.553614755626768e-05;0.0029018184868618846;0.002122323028743267;0.003263672988396138;-0.001141349959652871;0.0;1.2656785656872671e-05;0.0;1.2656785656872671e-05;0.0029018184868618846;0.0021096662430863944;0.003263672988396138;-0.0011540067453097436;Ureaplasma_cluster23
FVraw-5;14;0.000569843921542964;2.1917073905498617e-05;0.005725048948079348;0.01233989279717207;0.0024176277220249176;0.009922265075147152;0.021485986188054085;0.02881024405360222;0.015640949830412865;0.013169294223189354;0.0;0.00018439600535202771;0.0;0.00018439600535202771;0.00033800798701122403;0.002664724597707391;1.7542912246426567e-05;0.0026471816854609642;0.0;0.0;0.0;0.0;0.00033800798701122403;0.002664724597707391;1.7542912246426567e-05;0.0026471816854609642;Prevotella_amnii
FVraw-5;15;0.24378133196151025;0.17814789643341133;0.004400935024023056;0.008445804938673973;0.002378500532358885;0.006067304406315088;0.020271535962820053;0.0314803346991539;0.010422399267554283;0.021057935431599617;0.0;0.0;0.0;0.0;1.750821957102744e-05;6.146533269202337e-05;0.0;6.146533269202337e-05;0.0;0.0;0.0;0.0;1.750821957102744e-05;6.146533269202337e-05;0.0;6.146533269202337e-05;TM7_OTU-H1
FVraw-5;16;0.018764473220164234;0.005773684067742842;0.004378856625407934;0.005839729215949774;0.003648419864475727;0.0021913093514740467;0.014770347625017166;0.013671260327100754;0.01523786224424839;-0.0015666019171476364;0.0;0.0002648173540364951;0.0;0.0002648173540364951;0.0004954562900820747;0.0030407109297811985;0.00010928645860985853;0.00293142447117134;0.0;0.0;0.0;0.0;0.0004954562900820747;0.0030407109297811985;0.00010928645860985853;0.00293142447117134;Sneathia_sanguinegens
FVraw-5;17;0.7070251719188861;0.652638620232818;0.0018535119015723467;0.002016121055930853;0.001772207673639059;0.00024391338229179382;0.006399509962648153;0.006563183851540089;0.006314512342214584;0.0002486715093255043;9.74943905021064e-05;7.012327841948718e-05;0.00010284622840117663;-3.272294998168945e-05;0.0005455612554214895;0.00044100216473452747;0.0005544926680158824;-0.0001134905032813549;2.0211065930197947e-05;2.325527384527959e-05;1.9239620996813755e-05;4.015652848465834e-06;0.0005253501894912915;0.0004177468908892479;0.0005352530470190686;-0.00011750615612982074;Finegoldia_magna
FVraw-5;18;0.006964882404570926;0.0010715203699339887;0.003606026293709874;0.004726422019302845;0.0030458285473287106;0.0016805934719741344;0.010300126858055592;0.010417836718261242;0.010194694623351097;0.0002231420949101448;0.0;0.00020592020882759243;0.0;0.00020592020882759243;0.0009706247656140476;0.004244646057486534;0.00010303187264071312;0.004141614184845821;0.0;0.0;0.0;0.0;0.0009706247656140476;0.004244646057486534;0.00010303187264071312;0.004141614184845821;Clostridiales_BVAB2
FVraw-5;19;0.039381305977511834;0.018175987374236233;0.004580760840326548;0.0060197776183485985;0.003861252451315522;0.0021585251670330763;0.012429648078978062;0.012565625831484795;0.012298116460442543;0.0002675093710422516;0.00012919896107632667;0.0008324449299834669;1.758907819748856e-05;0.0008148558517859783;0.003368052653968334;0.004870428238064051;0.0024684775853529572;0.0024019506527110934;0.0;1.1627636922639795e-05;0.0;1.1627636922639795e-05;0.003368052653968334;0.004858800601141411;0.0024684775853529572;0.0023903230157884536;Aerococcus_christensenii
FVraw-5;20;0.02416409539610054;0.008364494560188649;0.004424701444804668;0.005627866368740797;0.0038231187500059605;0.0018047476187348366;0.008288195356726646;0.007916003465652466;0.008403810672461987;-0.0004878072068095207;1.1664255907817278e-05;0.0019801140297204256;0.0;0.0019801140297204256;0.0048171221278607845;0.00818200409412384;0.0024089848157018423;0.005773019278421998;0.0;0.0;0.0;0.0;0.0048171221278607845;0.00818200409412384;0.0024089848157018423;0.005773019278421998;Coriobacteriaceae_OTU27
FVraw-5;21;0.014864916271293514;0.003461667908571506;0.0031314538791775703;0.004402575083076954;0.0024958932772278786;0.0019066818058490753;0.006774988956749439;0.0072406623512506485;0.006436248775571585;0.0008044135756790638;0.0006264758412726223;0.0022529619745910168;0.00019908662943635136;0.0020538753451546654;0.002564630238339305;0.004138923715800047;0.0017998248804360628;0.002339098835363984;0.0;0.00027824152493849397;0.0;0.00027824152493849397;0.002564630238339305;0.003860682190861553;0.0017998248804360628;0.00206085731042549;Dialister_micraerophilus
FVraw-5;22;0.3879388319418781;0.3133352104145939;0.002191603882238269;0.003072424791753292;0.0017511934274807572;0.0013212313642725348;0.010218800976872444;0.009687132202088833;0.010446706786751747;-0.0007595745846629143;1.1495309991005342e-05;1.1627636922639795e-05;5.290725312079303e-06;6.336911610560492e-06;0.00022674095089314505;0.0021389967296272516;0.00011012868162652012;0.0020288680480007315;0.0;0.0;0.0;0.0;0.00022674095089314505;0.0021389967296272516;0.00011012868162652012;0.0020288680480007315;Prevotella_cluster50
FVraw-5;23;0.3254483681317135;0.2503448985628566;0.0030975828412920237;0.004819104913622141;0.0022368216887116432;0.0025822832249104977;0.014899017289280891;0.017193373292684555;0.013525618240237236;0.003667755052447319;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;Megasphaera_OTU71_type2
FVraw-5;24;0.008082330539621025;0.001554294334542505;0.0017037115758284926;0.0033475428353995085;0.000881795771420002;0.0024657470639795065;0.004018294624984264;0.0060075558722019196;0.00203667301684618;0.00397088285535574;0.0;0.0006237330380827188;0.0;0.0006237330380827188;0.0014084269059821963;0.0035112560726702213;0.00022043469289201312;0.003290821379778208;0.0;0.0;0.0;0.0;0.0014084269059821963;0.0035112560726702213;0.00022043469289201312;0.003290821379778208;Parvimonas_OTU142
FVraw-5;25;0.14417666148383523;0.09426935558558458;0.002080391626805067;0.003936965484172106;0.0011521048145368695;0.0027848606696352363;0.010068795643746853;0.014835243113338947;0.006280413828790188;0.00855482928454876;0.0;0.0;0.0;0.0;0.0;5.9775542467832565e-05;0.0;5.9775542467832565e-05;0.0;0.0;0.0;0.0;0.0;5.9775542467832565e-05;0.0;5.9775542467832565e-05;Prevotellaceae_OTU61
SIGNIF COUNT:12

Blue: TB, Red: PTB

On the plot, from left to right:
Lactobacillus_crispatus_cluster FDR-adjusted p-value:0.03249135776081749
Lachnospiraceae_BVAB1 FDR-adjusted p-value:0.02782175586751738
Prevotella_cluster2 FDR-adjusted p-value:0.014864916271293514
Sneathia_amnii FDR-adjusted p-value:0.0022605221267822224
Dialister_cluster51 FDR-adjusted p-value:0.004929699258044424
Prevotella_amnii FDR-adjusted p-value:0.000569843921542964
Sneathia_sanguinegens FDR-adjusted p-value:0.018764473220164234
Clostridiales_BVAB2 FDR-adjusted p-value:0.006964882404570926
Aerococcus_christensenii FDR-adjusted p-value:0.039381305977511834
Coriobacteriaceae_OTU27 FDR-adjusted p-value:0.02416409539610054
Dialister_micraerophilus FDR-adjusted p-value:0.014864916271293514
Parvimonas_OTU142 FDR-adjusted p-value:0.008082330539621025

￼


'''
    